<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="page-title">Hong Kong 468 Rule Calculator - Employment Contract Calculator</title>
    <meta name="description" id="page-description" content="Calculate whether your working hours qualify for continuous employment benefits under Hong Kong's new 468 rule">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --hk-red: #d42c2c;
            --hk-red-light: #e85555;
            --hk-red-dark: #b91c1c;
            --hk-yellow: #f7e600;
            --hk-yellow-light: #fff3cd;
            --success-green: #059669;
            --success-green-light: #10b981;
            --warning-orange: #d97706;
            --error-red: #dc2626;
            --gray-50: #f9fafb;
            --gray-100: #f3f4f6;
            --gray-200: #e5e7eb;
            --gray-300: #d1d5db;
            --gray-400: #9ca3af;
            --gray-500: #6b7280;
            --gray-600: #4b5563;
            --gray-700: #374151;
            --gray-800: #1f2937;
            --gray-900: #111827;
            --white: #ffffff;
            --light-blue: #e3f2fd;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: var(--gray-800);
            background: linear-gradient(135deg, var(--gray-50) 0%, var(--gray-100) 100%);
            min-height: 100vh;
        }

        .page-header {
            background: var(--white);
            border-bottom: 3px solid var(--hk-red);
            padding: 1rem 0;
            margin-bottom: 2rem;
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .header-icon {
            width: 48px;
            height: 48px;
            background: var(--hk-red);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            font-size: 24px;
        }

        .header-title {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--hk-red);
            margin: 0;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem 2rem;
        }

        .intro-section {
            background: var(--white);
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            margin-bottom: 3rem;
        }

        .intro-text {
            font-size: 1rem;
            line-height: 1.6;
            color: var(--gray-700);
            margin-bottom: 1.5rem;
        }

        .notice-section {
            margin-bottom: 1.5rem;
        }

        .notice-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--gray-800);
            margin-bottom: 0.75rem;
        }

        .notice-text {
            font-size: 0.95rem;
            line-height: 1.6;
            color: var(--gray-700);
            margin-bottom: 1rem;
        }

        .contact-info {
            font-size: 0.95rem;
            color: var(--gray-700);
            margin-bottom: 1rem;
        }

        .disclaimer {
            display: flex;
            align-items: flex-start;
            gap: 0.5rem;
            font-size: 0.9rem;
            color: var(--gray-600);
        }

        .disclaimer input[type="checkbox"] {
            margin-top: 0.25rem;
        }

        .form-section {
            background: var(--white);
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .section-header {
            background: var(--hk-yellow);
            padding: 1rem 2rem;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--gray-800);
            border-bottom: 1px solid #e0e0e0;
        }

        .form-content {
            padding: 2rem;
        }

        .form-group {
            margin-bottom: 2rem;
        }

        .form-label {
            display: block;
            font-size: 1rem;
            font-weight: 500;
            color: var(--gray-800);
            margin-bottom: 1rem;
        }

        .radio-group {
            display: flex;
            gap: 2rem;
            margin-bottom: 1.5rem;
        }

        .radio-option {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .radio-option input[type="radio"] {
            width: 18px;
            height: 18px;
            accent-color: var(--hk-red);
        }

        .radio-option label {
            font-size: 1rem;
            color: var(--gray-700);
            cursor: pointer;
        }

        .date-input-group {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .date-input {
            padding: 0.75rem;
            border: 2px solid var(--gray-300);
            border-radius: 4px;
            font-size: 1rem;
            width: 200px;
        }

        .date-input:focus {
            outline: none;
            border-color: var(--hk-red);
        }

        .calendar-icon {
            background: var(--gray-200);
            border: 1px solid var(--gray-300);
            padding: 0.75rem;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .next-step-btn {
            background: linear-gradient(135deg, #9c27b0, #673ab7);
            color: var(--white);
            border: none;
            padding: 0.75rem 2rem;
            border-radius: 4px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-left: auto;
            transition: all 0.2s ease;
        }

        .next-step-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(156, 39, 176, 0.3);
        }

        .calculator-section {
            background: var(--white);
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            margin-top: 2rem;
            display: none;
        }

        .table-container {
            overflow-x: auto;
            margin-bottom: 2rem;
            border-radius: 12px;
            border: 1px solid var(--gray-200);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 1rem;
        }

        thead {
            background: linear-gradient(135deg, var(--hk-red) 0%, var(--hk-red-dark) 100%);
            color: var(--white);
        }

        th {
            padding: 1rem;
            text-align: left;
            font-weight: 600;
            font-size: 1.1rem;
        }

        tbody tr {
            transition: all 0.2s ease;
        }

        tbody tr:nth-child(even) {
            background-color: var(--gray-50);
        }

        tbody tr:hover {
            background-color: var(--gray-100);
        }

        td {
            padding: 1rem;
            border-bottom: 1px solid var(--gray-200);
        }

        .week-label {
            font-weight: 600;
            color: var(--gray-700);
            min-width: 200px;
        }

        .hours-input {
            width: 100%;
            max-width: 120px;
            padding: 0.75rem;
            border: 2px solid var(--gray-300);
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.2s ease;
            background: var(--white);
        }

        .hours-input:focus {
            outline: none;
            border-color: var(--hk-red);
            box-shadow: 0 0 0 3px rgba(212, 44, 44, 0.1);
        }

        .hours-input:disabled {
            background-color: var(--gray-100);
            border-color: var(--gray-200);
            cursor: not-allowed;
            color: var(--gray-500);
        }

        .hours-input.error {
            border-color: var(--error-red);
            background-color: #fef2f2;
        }

        .status-badge {
            display: inline-block;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            font-weight: 600;
            font-size: 0.875rem;
            text-transform: uppercase;
            letter-spacing: 0.025em;
            min-width: 120px;
            text-align: center;
        }

        .status-fulfilled {
            background-color: #d1fae5;
            color: var(--success-green);
            border: 1px solid #a7f3d0;
        }

        .status-not-fulfilled {
            background-color: #fee2e2;
            color: var(--error-red);
            border: 1px solid #fecaca;
        }

        .status-pending {
            background-color: var(--gray-100);
            color: var(--gray-500);
            border: 1px solid var(--gray-300);
        }

        .error-message {
            display: block;
            color: var(--error-red);
            font-size: 0.875rem;
            margin-top: 0.25rem;
            font-weight: 500;
        }

        .controls {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .btn {
            padding: 0.875rem 2rem;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            text-transform: uppercase;
            letter-spacing: 0.025em;
            min-width: 140px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--hk-red) 0%, var(--hk-red-dark) 100%);
            color: var(--white);
            box-shadow: 0 4px 6px -1px rgba(212, 44, 44, 0.3);
        }

        .btn-primary:hover:not(:disabled) {
            transform: translateY(-1px);
            box-shadow: 0 6px 8px -1px rgba(212, 44, 44, 0.4);
        }

        .btn-secondary {
            background: var(--white);
            color: var(--gray-700);
            border: 2px solid var(--gray-300);
        }

        .btn-secondary:hover {
            background: var(--gray-50);
            border-color: var(--gray-400);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }

        .results-summary {
            background: linear-gradient(135deg, var(--gray-50) 0%, var(--white) 100%);
            padding: 2rem;
            border-radius: 12px;
            border: 1px solid var(--gray-200);
            margin-top: 2rem;
        }

        .results-summary h3 {
            font-size: 1.5rem;
            color: var(--gray-800);
            margin-bottom: 1rem;
            font-weight: 700;
            text-align: center;
        }

        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .summary-card {
            background: var(--white);
            padding: 1.5rem;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .summary-card h4 {
            font-size: 0.875rem;
            color: var(--gray-600);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 0.5rem;
        }

        .summary-card .value {
            font-size: 2rem;
            font-weight: 800;
            color: var(--hk-red);
            margin-bottom: 0.25rem;
        }

        .summary-card .description {
            font-size: 0.875rem;
            color: var(--gray-600);
        }

        .qualification-status {
            text-align: center;
            padding: 1.5rem;
            border-radius: 10px;
            font-size: 1.25rem;
            font-weight: 700;
        }

        .qualification-status.qualified {
            background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%);
            color: var(--success-green);
            border: 2px solid #6ee7b7;
        }

        .qualification-status.not-qualified {
            background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);
            color: var(--error-red);
            border: 2px solid #f87171;
        }

        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .legend {
            display: flex;
            gap: 2rem;
            justify-content: center;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
            color: var(--gray-600);
        }

        .legend-color {
            width: 16px;
            height: 16px;
            border-radius: 4px;
        }

        .language-switcher {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            display: flex;
            gap: 0.5rem;
            background: var(--white);
            padding: 0.5rem;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            border: 1px solid var(--gray-200);
        }

        .lang-btn {
            padding: 0.5rem 0.75rem;
            border: 1px solid var(--gray-300);
            background: var(--white);
            color: var(--gray-600);
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 500;
            transition: all 0.2s ease;
            min-width: 40px;
            text-align: center;
        }

        .lang-btn:hover {
            background: var(--gray-50);
            border-color: var(--gray-400);
        }

        .lang-btn.active {
            background: var(--hk-red);
            color: var(--white);
            border-color: var(--hk-red);
        }

        @media (max-width: 768px) {
            .container {
                padding: 1rem 0.5rem;
            }

            header {
                padding: 2rem 1rem;
            }

            h1 {
                font-size: 2rem;
            }

            main {
                padding: 1rem;
            }

            .methods {
                grid-template-columns: 1fr;
            }

            table {
                font-size: 0.875rem;
            }

            th, td {
                padding: 0.75rem 0.5rem;
            }

            .week-label {
                min-width: 150px;
                font-size: 0.875rem;
            }

            .hours-input {
                max-width: 100px;
                padding: 0.5rem;
            }

            .controls {
                flex-direction: column;
                align-items: center;
            }

            .btn {
                width: 100%;
                max-width: 300px;
            }

            .legend {
                flex-direction: column;
                align-items: center;
                gap: 1rem;
            }

            .language-switcher {
                position: relative;
                top: auto;
                right: auto;
                margin-bottom: 1rem;
                justify-content: center;
            }

            .header-content {
                flex-direction: column;
                text-align: center;
            }

            .radio-group {
                flex-direction: column;
                gap: 1rem;
            }

            .date-input-group {
                flex-direction: column;
                align-items: flex-start;
            }

            .next-step-btn {
                margin: 0 auto;
            }
        }
    </style>
</head>
<body>
    <div class="page-header">
        <div class="header-content">
            <div class="header-icon">ğŸ“Š</div>
            <h1 class="header-title" data-i18n="title">æ³•å®šåƒ±å‚­æ¬Šç›Šåƒè€ƒè¨ˆç®—æ©Ÿ</h1>
        </div>
    </div>

    <div class="language-switcher">
        <button class="lang-btn active" data-lang="en">EN</button>
        <button class="lang-btn" data-lang="zh-hk">ç¹</button>
        <button class="lang-btn" data-lang="zh-cn">ç®€</button>
    </div>

    <div class="container">
        <div class="intro-section">
            <p class="intro-text" data-i18n="intro-text">
                æ³•å®šåƒ±å‚­æ¬Šç›Šåƒè€ƒè¨ˆç®—æ©Ÿç¨‹å¼ï¼Œæ—¨åœ¨æä¾›ä¸€å€‹ç°¡ä¾¿çš„å·¥å…·ï¼Œå”åŠ©åƒ±ä¸»åŠåƒ±å“¡æ ¹æ“šã€Šåƒ±å‚­æ¢ä¾‹ã€‹åˆæ­¥è¨ˆç®—åƒ±å‚­æ¬Šç›Šï¼Œä»¥ä½œåƒè€ƒä¹‹ç”¨ã€‚è¼¸å…¥å…¨éƒ¨æ‰€éœ€è³‡æ–™å¾Œï¼ŒæŒ‰ã€Œè¨ˆç®—ã€æŒ‰éˆ•ï¼Œç¨‹å¼ä¾¿æœƒè¨ˆç®—åƒ±å“¡æ ¹æ“šã€Šåƒ±å‚­æ¢ä¾‹ã€‹å¯äº«æœ‰çš„åƒ±å‚­æ¬Šç›ŠåŠç›¸é—œé‡‘é¡ã€‚
            </p>

            <div class="notice-section">
                <h3 class="notice-title" data-i18n="notice-title">æ³¨æ„</h3>
                <p class="notice-text" data-i18n="notice-text">
                    æœ¬è¨ˆç®—æ©Ÿç¨‹å¼æ˜¯åŸºæ–¼ã€Šåƒ±å‚­æ¢ä¾‹ã€‹ä¸‹æ³•å®šæ¬Šç›Šçš„ç›¸é—œæ¢æ–‡ã€ä½¿ç”¨è€…è¼¸å…¥çš„è³‡æ–™ï¼ŒåŠä¸€äº›å‡è¨­ç‹€æ³ä½œé‹ç®—ï¼Œè¨ˆç®—çµæœåªä¾›åˆæ­¥åƒè€ƒã€‚ç²¾ç¢ºçš„æ³•å®šåƒ±å‚­æ¬Šç›Šè¨ˆç®—ï¼Œéœ€è¦è€ƒæ…®åƒ±å‚­åˆç´„å…§çš„æ¢æ¬¾ä»¥åŠå€‹åˆ¥å€‹æ¡ˆçš„å¯¦éš›æƒ…æ³ï¼Œè€Œé€™äº›å› ç´ æœƒå› æ‡‰å€‹åˆ¥å€‹æ¡ˆè€Œæœ‰æ‰€ä¸åŒï¼Œæ•…æ­¤å¯èƒ½æœªå®Œå…¨åæ˜ åœ¨æ­¤è¨ˆç®—æ©Ÿç¨‹å¼çš„è¨ˆç®—ä¹‹å…§ã€‚å‹å·¥è™•å°æ–¼å› é€™äº›è³‡æ–™å…§å®¹æˆ–å› ä½¿ç”¨é€™äº›è³‡æ–™æ‰€å¼•è‡´çš„ä»»ä½•æå¤±ï¼Œä¸€æ¦‚ä¸è² ä»»ä½•è²¬ä»»ã€‚æ­¤è¨ˆç®—æ©Ÿç¨‹å¼æ‰€æä¾›çš„è³‡æ–™ï¼Œä¸æ‡‰è¢«è¦–ç”¨åœ¨ä»»ä½•æ³•å¾‹ç¨‹åºä¸Šï¼Œæˆ–è¢«è¦–ç‚ºç”³ç´¢çš„è­‰æ“šã€‚
                </p>
                <p class="contact-info" data-i18n="contact-info">
                    æœ‰é—œè¨ˆç®—æ³•å®šåƒ±å‚­æ¬Šç›Šçš„è©³æƒ…ï¼Œè«‹åƒé–±ã€Šåƒ±å‚­æ¢ä¾‹ç°¡æ˜æŒ‡å—ã€‹æˆ–è‡´é›» 24 å°æ™‚æŸ¥è©¢ç†±ç·š 2717 1771ï¼ˆç”±ã€Œ1823ã€æ¥è½ï¼‰ï¼Œä½ äº¦å¯ç€è¦½åˆ°å‹å·¥è™•å‹è³‡é—œä¿‚ç§‘çš„åˆ†å€è¾¦äº‹è™•æŸ¥è©¢ï¼Œè«‹æŒ‰æ­¤æŸ¥é–±å„åˆ†å€è¾¦äº‹è™•çš„åœ°å€ã€‚
                </p>
                <div class="disclaimer">
                    <input type="checkbox" id="agree-checkbox">
                    <label for="agree-checkbox" data-i18n="disclaimer">æœ¬äººå·²é–±è®€ã€æ˜ç™½åŠåŒæ„ä¸Šè¿°å…§å®¹ã€‚</label>
                </div>
            </div>
        </div>

        <div class="form-section">
            <div class="section-header" data-i18n="basic-info">åŸºæœ¬è³‡æ–™</div>
            <div class="form-content">
                <div class="form-group">
                    <label class="form-label" data-i18n="continuous-contract-question">æ˜¯å¦æŒ‰é€£çºŒæ€§åˆç´„å—åƒ±ï¼Ÿï¼ˆè¨»ï¼‰</label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" id="continuous-yes" name="continuous-contract" value="yes">
                            <label for="continuous-yes" data-i18n="yes">æ˜¯</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="continuous-no" name="continuous-contract" value="no">
                            <label for="continuous-no" data-i18n="no">å¦</label>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label" data-i18n="part-time-question">æ˜¯å¦å…¼è·åœ¨è·ï¼Ÿ</label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" id="parttime-yes" name="part-time" value="yes">
                            <label for="parttime-yes" data-i18n="yes">æ˜¯</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="parttime-no" name="part-time" value="no">
                            <label for="parttime-no" data-i18n="no">å¦</label>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label" data-i18n="start-date-question">é–‹å§‹å—åƒ±æ—¥ï¼šï¼ˆè¨»ï¼‰</label>
                    <div class="date-input-group">
                        <input type="date" class="date-input" id="employment-start-date">
                        <div class="calendar-icon">ğŸ“…</div>
                    </div>
                </div>

                <div style="display: flex; justify-content: flex-end; margin-top: 2rem;">
                    <button class="next-step-btn" id="next-step-btn" data-i18n="next-step">
                        â–¶ ä¸‹ä¸€æ­¥
                    </button>
                </div>
            </div>
        </div>

        <div class="calculator-section" id="calculator-section">
            <div class="section-header" data-i18n="hours-calculator">å·¥æ™‚è¨ˆç®—å™¨</div>
            <div class="calculator-header">
                <h2 data-i18n="calculator-title">æ¯é€±å·¥æ™‚è¨ˆç®—å™¨</h2>
                <p class="calculator-subtitle" data-i18n="calculator-subtitle">Enter hours worked for each week (0-168 hours). Complete weeks sequentially.</p>
            </div>

            <div class="legend">
                <div class="legend-item">
                    <div class="legend-color" style="background-color: #d1fae5; border: 1px solid #a7f3d0;"></div>
                    <span data-i18n="legend-qualified">Qualified for Benefits</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background-color: #fee2e2; border: 1px solid #fecaca;"></div>
                    <span data-i18n="legend-not-qualified">Not Qualified</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background-color: #f3f4f6; border: 1px solid #d1d5db;"></div>
                    <span data-i18n="legend-pending">Pending Input</span>
                </div>
            </div>

            <div class="table-container">
                <table id="calculator-table">
                    <thead>
                        <tr>
                            <th data-i18n="table-week">Week</th>
                            <th data-i18n="table-hours">Hours Worked</th>
                            <th data-i18n="table-status">Status</th>
                        </tr>
                    </thead>
                    <tbody id="week-rows">
                        <!-- Dynamically generated rows -->
                    </tbody>
                </table>
            </div>

            <div class="controls">
                <button id="calculate-btn" class="btn btn-primary" data-i18n="btn-calculate">Calculate Results</button>
                <button id="reset-btn" class="btn btn-secondary" data-i18n="btn-reset">Reset Form</button>
            </div>

            <div id="summary-results" class="results-summary" style="display: none;">
                <h3 data-i18n="summary-title">Qualification Summary</h3>
                <div class="summary-grid">
                    <div class="summary-card">
                        <h4 data-i18n="summary-weeks-completed">Weeks Completed</h4>
                        <div class="value" id="weeks-completed">0</div>
                        <div class="description" data-i18n="summary-weeks-total">of 12 weeks</div>
                    </div>
                    <div class="summary-card">
                        <h4 data-i18n="summary-qualified-weeks">Qualified Weeks</h4>
                        <div class="value" id="qualified-weeks">0</div>
                        <div class="description" data-i18n="summary-qualified-desc">weeks qualifying for benefits</div>
                    </div>
                    <div class="summary-card">
                        <h4 data-i18n="summary-first-qualification">First Qualification</h4>
                        <div class="value" id="first-qualification">--</div>
                        <div class="description" data-i18n="summary-first-desc">week first qualified</div>
                    </div>
                </div>
                <div id="qualification-status" class="qualification-status">
                    <!-- Status will be updated dynamically -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global state
        let currentLanguage = 'en';
        let weekData = [];
        let calculationResults = [];

        // Translations
        const translations = {
            'en': {
                'title': 'Hong Kong 468 Rule Calculator',
                'subtitle': 'Employment Contract Benefits Eligibility Tool',
                'understanding-title': 'Understanding the 468 Rule',
                'understanding-desc': 'Under the Employment Ordinance amendments (effective January 18, 2026), employees can qualify for continuous contract benefits through either of two methods:',
                'method1-title': 'Method 1: Weekly Hours',
                'method1-desc': '<strong>17+ hours per week</strong> for 4 consecutive weeks qualifies you for continuous employment benefits.',
                'method2-title': 'Method 2: Aggregate Hours',
                'method2-desc': '<strong>68+ total hours</strong> over any 4 consecutive weeks qualifies you for continuous employment benefits.',
                'instruction': 'Enter your working hours for each week below to see if and when you qualify for continuous employment contract benefits.',
                'calculator-title': 'Weekly Hours Calculator',
                'calculator-subtitle': 'Enter hours worked for each week (0-168 hours). Complete weeks sequentially.',
                'legend-qualified': 'Qualified for Benefits',
                'legend-not-qualified': 'Not Qualified',
                'legend-pending': 'Pending Input',
                'table-week': 'Week',
                'table-hours': 'Hours Worked',
                'table-status': 'Status',
                'btn-calculate': 'Calculate Results',
                'btn-reset': 'Reset Form',
                'summary-title': 'Qualification Summary',
                'summary-weeks-completed': 'Weeks Completed',
                'summary-weeks-total': 'of 12 weeks',
                'summary-qualified-weeks': 'Qualified Weeks',
                'summary-qualified-desc': 'weeks qualifying for benefits',
                'summary-first-qualification': 'First Qualification',
                'summary-first-desc': 'week first qualified',
                'status-qualified': 'Qualified',
                'status-not-qualified': 'Not Qualified',
                'status-pending': 'Pending',
                'week-label': 'Working hours of the {ordinal} week',
                'qualified-message': 'âœ… Congratulations! You qualify for continuous employment benefits',
                'not-qualified-message': 'âŒ Based on current hours, you do not qualify for continuous employment benefits yet',
                'pending-message': 'â³ Enter at least 4 weeks of data to determine qualification status'
            },
            'zh-hk': {
                'title': 'é¦™æ¸¯468è¦å‰‡è¨ˆç®—å™¨',
                'intro-text': 'æ³•å®šåƒ±å‚­æ¬Šç›Šåƒè€ƒè¨ˆç®—æ©Ÿç¨‹å¼ï¼Œæ—¨åœ¨æä¾›ä¸€å€‹ç°¡ä¾¿çš„å·¥å…·ï¼Œå”åŠ©åƒ±ä¸»åŠåƒ±å“¡æ ¹æ“šã€Šåƒ±å‚­æ¢ä¾‹ã€‹åˆæ­¥è¨ˆç®—åƒ±å‚­æ¬Šç›Šï¼Œä»¥ä½œåƒè€ƒä¹‹ç”¨ã€‚è¼¸å…¥å…¨éƒ¨æ‰€éœ€è³‡æ–™å¾Œï¼ŒæŒ‰ã€Œè¨ˆç®—ã€æŒ‰éˆ•ï¼Œç¨‹å¼ä¾¿æœƒè¨ˆç®—åƒ±å“¡æ ¹æ“šã€Šåƒ±å‚­æ¢ä¾‹ã€‹å¯äº«æœ‰çš„åƒ±å‚­æ¬Šç›ŠåŠç›¸é—œé‡‘é¡ã€‚',
                'notice-title': 'æ³¨æ„',
                'notice-text': 'æœ¬è¨ˆç®—æ©Ÿç¨‹å¼æ˜¯åŸºæ–¼ã€Šåƒ±å‚­æ¢ä¾‹ã€‹ä¸‹æ³•å®šæ¬Šç›Šçš„ç›¸é—œæ¢æ–‡ã€ä½¿ç”¨è€…è¼¸å…¥çš„è³‡æ–™ï¼ŒåŠä¸€äº›å‡è¨­ç‹€æ³ä½œé‹ç®—ï¼Œè¨ˆç®—çµæœåªä¾›åˆæ­¥åƒè€ƒã€‚ç²¾ç¢ºçš„æ³•å®šåƒ±å‚­æ¬Šç›Šè¨ˆç®—ï¼Œéœ€è¦è€ƒæ…®åƒ±å‚­åˆç´„å…§çš„æ¢æ¬¾ä»¥åŠå€‹åˆ¥å€‹æ¡ˆçš„å¯¦éš›æƒ…æ³ï¼Œè€Œé€™äº›å› ç´ æœƒå› æ‡‰å€‹åˆ¥å€‹æ¡ˆè€Œæœ‰æ‰€ä¸åŒï¼Œæ•…æ­¤å¯èƒ½æœªå®Œå…¨åæ˜ åœ¨æ­¤è¨ˆç®—æ©Ÿç¨‹å¼çš„è¨ˆç®—ä¹‹å…§ã€‚å‹å·¥è™•å°æ–¼å› é€™äº›è³‡æ–™å…§å®¹æˆ–å› ä½¿ç”¨é€™äº›è³‡æ–™æ‰€å¼•è‡´çš„ä»»ä½•æå¤±ï¼Œä¸€æ¦‚ä¸è² ä»»ä½•è²¬ä»»ã€‚æ­¤è¨ˆç®—æ©Ÿç¨‹å¼æ‰€æä¾›çš„è³‡æ–™ï¼Œä¸æ‡‰è¢«è¦–ç”¨åœ¨ä»»ä½•æ³•å¾‹ç¨‹åºä¸Šï¼Œæˆ–è¢«è¦–ç‚ºç”³ç´¢çš„è­‰æ“šã€‚',
                'contact-info': 'æœ‰é—œè¨ˆç®—æ³•å®šåƒ±å‚­æ¬Šç›Šçš„è©³æƒ…ï¼Œè«‹åƒé–±ã€Šåƒ±å‚­æ¢ä¾‹ç°¡æ˜æŒ‡å—ã€‹æˆ–è‡´é›» 24 å°æ™‚æŸ¥è©¢ç†±ç·š 2717 1771ï¼ˆç”±ã€Œ1823ã€æ¥è½ï¼‰ï¼Œä½ äº¦å¯ç€è¦½åˆ°å‹å·¥è™•å‹è³‡é—œä¿‚ç§‘çš„åˆ†å€è¾¦äº‹è™•æŸ¥è©¢ï¼Œè«‹æŒ‰æ­¤æŸ¥é–±å„åˆ†å€è¾¦äº‹è™•çš„åœ°å€ã€‚',
                'disclaimer': 'æœ¬äººå·²é–±è®€ã€æ˜ç™½åŠåŒæ„ä¸Šè¿°å…§å®¹ã€‚',
                'basic-info': 'åŸºæœ¬è³‡æ–™',
                'continuous-contract-question': 'æ˜¯å¦æŒ‰é€£çºŒæ€§åˆç´„å—åƒ±ï¼Ÿï¼ˆè¨»ï¼‰',
                'part-time-question': 'æ˜¯å¦å…¼è·åœ¨è·ï¼Ÿ',
                'start-date-question': 'é–‹å§‹å—åƒ±æ—¥ï¼šï¼ˆè¨»ï¼‰',
                'yes': 'æ˜¯',
                'no': 'å¦',
                'next-step': 'â–¶ ä¸‹ä¸€æ­¥',
                'hours-calculator': 'å·¥æ™‚è¨ˆç®—å™¨',
                'calculator-title': 'æ¯é€±å·¥æ™‚è¨ˆç®—å™¨',
                'calculator-subtitle': 'è«‹è¼¸å…¥æ¯é€±å·¥ä½œæ™‚æ•¸ï¼ˆ0-168å°æ™‚ï¼‰ã€‚è«‹æŒ‰é †åºå®Œæˆå„é€±ã€‚',
                'legend-qualified': 'ç¬¦åˆç¦åˆ©è³‡æ ¼',
                'legend-not-qualified': 'ä¸ç¬¦åˆè³‡æ ¼',
                'legend-pending': 'å¾…è¼¸å…¥',
                'table-week': 'é€±æ¬¡',
                'table-hours': 'å·¥ä½œæ™‚æ•¸',
                'table-status': 'ç‹€æ…‹',
                'btn-calculate': 'è¨ˆç®—çµæœ',
                'btn-reset': 'é‡è¨­è¡¨æ ¼',
                'summary-title': 'è³‡æ ¼æ‘˜è¦',
                'summary-weeks-completed': 'å·²å®Œæˆé€±æ•¸',
                'summary-weeks-total': 'å…±12é€±',
                'summary-qualified-weeks': 'ç¬¦åˆè³‡æ ¼é€±æ•¸',
                'summary-qualified-desc': 'ç¬¦åˆç¦åˆ©è³‡æ ¼çš„é€±æ•¸',
                'summary-first-qualification': 'é¦–æ¬¡ç¬¦åˆè³‡æ ¼',
                'summary-first-desc': 'é¦–æ¬¡ç¬¦åˆè³‡æ ¼çš„é€±æ¬¡',
                'status-qualified': 'ç¬¦åˆè³‡æ ¼',
                'status-not-qualified': 'ä¸ç¬¦åˆè³‡æ ¼',
                'status-pending': 'å¾…å®š',
                'week-label': 'ç¬¬{ordinal}é€±å·¥ä½œæ™‚æ•¸',
                'qualified-message': 'âœ… æ­å–œï¼æ‚¨ç¬¦åˆé€£çºŒæ€§åƒ±å‚­ç¦åˆ©è³‡æ ¼',
                'not-qualified-message': 'âŒ æ ¹æ“šç›®å‰å·¥æ™‚ï¼Œæ‚¨æš«æœªç¬¦åˆé€£çºŒæ€§åƒ±å‚­ç¦åˆ©è³‡æ ¼',
                'pending-message': 'â³ è«‹è¼¸å…¥è‡³å°‘4é€±æ•¸æ“šä»¥ç¢ºå®šè³‡æ ¼ç‹€æ…‹'
            },
            'zh-cn': {
                'title': 'é¦™æ¸¯468è§„åˆ™è®¡ç®—å™¨',
                'intro-text': 'æ³•å®šé›‡ä½£æƒç›Šå‚è€ƒè®¡ç®—æœºç¨‹å¼ï¼Œæ—¨åœ¨æä¾›ä¸€ä¸ªç®€ä¾¿çš„å·¥å…·ï¼ŒååŠ©é›‡ä¸»åŠé›‡å‘˜æ ¹æ®ã€Šé›‡ä½£æ¡ä¾‹ã€‹åˆæ­¥è®¡ç®—é›‡ä½£æƒç›Šï¼Œä»¥ä½œå‚è€ƒä¹‹ç”¨ã€‚è¾“å…¥å…¨éƒ¨æ‰€éœ€èµ„æ–™åï¼ŒæŒ‰ã€Œè®¡ç®—ã€æŒ‰é’®ï¼Œç¨‹å¼ä¾¿ä¼šè®¡ç®—é›‡å‘˜æ ¹æ®ã€Šé›‡ä½£æ¡ä¾‹ã€‹å¯äº«æœ‰çš„é›‡ä½£æƒç›ŠåŠç›¸å…³é‡‘é¢ã€‚',
                'notice-title': 'æ³¨æ„',
                'notice-text': 'æœ¬è®¡ç®—æœºç¨‹å¼æ˜¯åŸºäºã€Šé›‡ä½£æ¡ä¾‹ã€‹ä¸‹æ³•å®šæƒç›Šçš„ç›¸å…³æ¡æ–‡ã€ä½¿ç”¨è€…è¾“å…¥çš„èµ„æ–™ï¼ŒåŠä¸€äº›å‡è®¾çŠ¶å†µä½œè¿ç®—ï¼Œè®¡ç®—ç»“æœåªä¾›åˆæ­¥å‚è€ƒã€‚ç²¾ç¡®çš„æ³•å®šé›‡ä½£æƒç›Šè®¡ç®—ï¼Œéœ€è¦è€ƒè™‘é›‡ä½£åˆçº¦å†…çš„æ¡æ¬¾ä»¥åŠä¸ªåˆ«ä¸ªæ¡ˆçš„å®é™…æƒ…å†µï¼Œè€Œè¿™äº›å› ç´ ä¼šå› åº”ä¸ªåˆ«ä¸ªæ¡ˆè€Œæœ‰æ‰€ä¸åŒï¼Œæ•…æ­¤å¯èƒ½æœªå®Œå…¨åæ˜ åœ¨æ­¤è®¡ç®—æœºç¨‹å¼çš„è®¡ç®—ä¹‹å†…ã€‚åŠ³å·¥å¤„å¯¹äºå› è¿™äº›èµ„æ–™å†…å®¹æˆ–å› ä½¿ç”¨è¿™äº›èµ„æ–™æ‰€å¼•è‡´çš„ä»»ä½•æŸå¤±ï¼Œä¸€æ¦‚ä¸è´Ÿä»»ä½•è´£ä»»ã€‚æ­¤è®¡ç®—æœºç¨‹å¼æ‰€æä¾›çš„èµ„æ–™ï¼Œä¸åº”è¢«è§†ç”¨åœ¨ä»»ä½•æ³•å¾‹ç¨‹åºä¸Šï¼Œæˆ–è¢«è§†ä¸ºç”³ç´¢çš„è¯æ®ã€‚',
                'contact-info': 'æœ‰å…³è®¡ç®—æ³•å®šé›‡ä½£æƒç›Šçš„è¯¦æƒ…ï¼Œè¯·å‚é˜…ã€Šé›‡ä½£æ¡ä¾‹ç®€æ˜æŒ‡å—ã€‹æˆ–è‡´ç”µ 24 å°æ—¶æŸ¥è¯¢çƒ­çº¿ 2717 1771ï¼ˆç”±ã€Œ1823ã€æ¥å¬ï¼‰ï¼Œä½ äº¦å¯æµè§ˆåˆ°åŠ³å·¥å¤„åŠ³èµ„å…³ç³»ç§‘çš„åˆ†åŒºåŠäº‹å¤„æŸ¥è¯¢ï¼Œè¯·æŒ‰æ­¤æŸ¥é˜…å„åˆ†åŒºåŠäº‹å¤„çš„åœ°å€ã€‚',
                'disclaimer': 'æœ¬äººå·²é˜…è¯»ã€æ˜ç™½åŠåŒæ„ä¸Šè¿°å†…å®¹ã€‚',
                'basic-info': 'åŸºæœ¬èµ„æ–™',
                'continuous-contract-question': 'æ˜¯å¦æŒ‰è¿ç»­æ€§åˆçº¦å—é›‡ï¼Ÿï¼ˆæ³¨ï¼‰',
                'part-time-question': 'æ˜¯å¦å…¼èŒåœ¨èŒï¼Ÿ',
                'start-date-question': 'å¼€å§‹å—é›‡æ—¥ï¼šï¼ˆæ³¨ï¼‰',
                'yes': 'æ˜¯',
                'no': 'å¦',
                'next-step': 'â–¶ ä¸‹ä¸€æ­¥',
                'hours-calculator': 'å·¥æ—¶è®¡ç®—å™¨',
                'calculator-title': 'æ¯å‘¨å·¥æ—¶è®¡ç®—å™¨',
                'calculator-subtitle': 'è¯·è¾“å…¥æ¯å‘¨å·¥ä½œæ—¶æ•°ï¼ˆ0-168å°æ—¶ï¼‰ã€‚è¯·æŒ‰é¡ºåºå®Œæˆå„å‘¨ã€‚',
                'legend-qualified': 'ç¬¦åˆç¦åˆ©èµ„æ ¼',
                'legend-not-qualified': 'ä¸ç¬¦åˆèµ„æ ¼',
                'legend-pending': 'å¾…è¾“å…¥',
                'table-week': 'å‘¨æ¬¡',
                'table-hours': 'å·¥ä½œæ—¶æ•°',
                'table-status': 'çŠ¶æ€',
                'btn-calculate': 'è®¡ç®—ç»“æœ',
                'btn-reset': 'é‡ç½®è¡¨æ ¼',
                'summary-title': 'èµ„æ ¼æ‘˜è¦',
                'summary-weeks-completed': 'å·²å®Œæˆå‘¨æ•°',
                'summary-weeks-total': 'å…±12å‘¨',
                'summary-qualified-weeks': 'ç¬¦åˆèµ„æ ¼å‘¨æ•°',
                'summary-qualified-desc': 'ç¬¦åˆç¦åˆ©èµ„æ ¼çš„å‘¨æ•°',
                'summary-first-qualification': 'é¦–æ¬¡ç¬¦åˆèµ„æ ¼',
                'summary-first-desc': 'é¦–æ¬¡ç¬¦åˆèµ„æ ¼çš„å‘¨æ¬¡',
                'status-qualified': 'ç¬¦åˆèµ„æ ¼',
                'status-not-qualified': 'ä¸ç¬¦åˆèµ„æ ¼',
                'status-pending': 'å¾…å®š',
                'week-label': 'ç¬¬{ordinal}å‘¨å·¥ä½œæ—¶æ•°',
                'qualified-message': 'âœ… æ­å–œï¼æ‚¨ç¬¦åˆè¿ç»­æ€§é›‡ä½£ç¦åˆ©èµ„æ ¼',
                'not-qualified-message': 'âŒ æ ¹æ®ç›®å‰å·¥æ—¶ï¼Œæ‚¨æš‚æœªç¬¦åˆè¿ç»­æ€§é›‡ä½£ç¦åˆ©èµ„æ ¼',
                'pending-message': 'â³ è¯·è¾“å…¥è‡³å°‘4å‘¨æ•°æ®ä»¥ç¡®å®šèµ„æ ¼çŠ¶æ€'
            }
        };

        // Error messages
        const errorMessages = {
            'en': {
                INVALID_NUMBER: "Please enter a valid number of hours",
                EXCEEDS_LIMIT: "Hours cannot exceed 168 per week",
                NEGATIVE_VALUE: "Hours cannot be negative",
                SEQUENTIAL_ERROR: "Please complete previous weeks first"
            },
            'zh-hk': {
                INVALID_NUMBER: "è«‹è¼¸å…¥æœ‰æ•ˆçš„å·¥ä½œæ™‚æ•¸",
                EXCEEDS_LIMIT: "æ¯é€±å·¥æ™‚ä¸èƒ½è¶…é168å°æ™‚",
                NEGATIVE_VALUE: "å·¥æ™‚ä¸èƒ½ç‚ºè² æ•¸",
                SEQUENTIAL_ERROR: "è«‹å…ˆå®Œæˆå‰é¢çš„é€±æ¬¡"
            },
            'zh-cn': {
                INVALID_NUMBER: "è¯·è¾“å…¥æœ‰æ•ˆçš„å·¥ä½œæ—¶æ•°",
                EXCEEDS_LIMIT: "æ¯å‘¨å·¥æ—¶ä¸èƒ½è¶…è¿‡168å°æ—¶",
                NEGATIVE_VALUE: "å·¥æ—¶ä¸èƒ½ä¸ºè´Ÿæ•°",
                SEQUENTIAL_ERROR: "è¯·å…ˆå®Œæˆå‰é¢çš„å‘¨æ¬¡"
            }
        };

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            initializeFormHandlers();
            initializeTable();
            attachEventListeners();
            initializeLanguageSwitcher();
        });

        function initializeFormHandlers() {
            const nextStepBtn = document.getElementById('next-step-btn');
            const agreeCheckbox = document.getElementById('agree-checkbox');
            
            // Initially disable next step button
            nextStepBtn.disabled = true;
            nextStepBtn.style.opacity = '0.5';
            
            // Enable next step when checkbox is checked
            agreeCheckbox.addEventListener('change', function() {
                if (this.checked) {
                    nextStepBtn.disabled = false;
                    nextStepBtn.style.opacity = '1';
                } else {
                    nextStepBtn.disabled = true;
                    nextStepBtn.style.opacity = '0.5';
                }
            });
            
            // Show calculator section when next step is clicked
            nextStepBtn.addEventListener('click', function() {
                if (!this.disabled) {
                    document.getElementById('calculator-section').style.display = 'block';
                    document.getElementById('calculator-section').scrollIntoView({ 
                        behavior: 'smooth', 
                        block: 'start' 
                    });
                }
            });
        }

        function initializeLanguageSwitcher() {
            const langButtons = document.querySelectorAll('.lang-btn');
            langButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    const lang = this.getAttribute('data-lang');
                    switchLanguage(lang);
                });
            });
        }

        function switchLanguage(lang) {
            currentLanguage = lang;
            
            // Update active button
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[data-lang="${lang}"]`).classList.add('active');
            
            // Update all translatable elements
            document.querySelectorAll('[data-i18n]').forEach(element => {
                const key = element.getAttribute('data-i18n');
                if (translations[lang] && translations[lang][key]) {
                    element.innerHTML = translations[lang][key];
                }
            });
            
            // Update page title and meta description
            document.getElementById('page-title').textContent = translations[lang]['title'];
            document.getElementById('page-description').setAttribute('content', translations[lang]['subtitle']);
            
            // Update week labels
            updateWeekLabels();
            
            // Update status badges
            updateStatusBadges();
            
            // Update qualification status if visible
            const summaryResults = document.getElementById('summary-results');
            if (summaryResults.style.display !== 'none') {
                displayResults();
            }
        }

        function updateWeekLabels() {
            for (let i = 1; i <= 12; i++) {
                const weekLabel = document.querySelector(`#week-rows tr:nth-child(${i}) .week-label`);
                if (weekLabel) {
                    const ordinal = getOrdinal(i);
                    weekLabel.textContent = translations[currentLanguage]['week-label'].replace('{ordinal}', ordinal);
                }
            }
        }

        function updateStatusBadges() {
            for (let i = 1; i <= 12; i++) {
                const statusElement = document.getElementById(`status-${i}`);
                if (statusElement) {
                    const currentStatus = statusElement.classList.contains('status-fulfilled') ? 'qualified' :
                                        statusElement.classList.contains('status-not-fulfilled') ? 'not-qualified' : 'pending';
                    const statusKey = `status-${currentStatus}`;
                    statusElement.textContent = translations[currentLanguage][statusKey];
                }
            }
        }

        function initializeTable() {
            const tbody = document.getElementById('week-rows');
            
            for (let i = 1; i <= 12; i++) {
                const row = createWeekRow(i);
                tbody.appendChild(row);
            }
            
            // Initialize week data array
            weekData = new Array(12).fill(null);
            
            // Enable first week input
            document.getElementById('week-1').disabled = false;
        }

        function createWeekRow(weekNumber) {
            const row = document.createElement('tr');
            const ordinal = getOrdinal(weekNumber);
            row.innerHTML = `
                <td class="week-label">${translations[currentLanguage]['week-label'].replace('{ordinal}', ordinal)}</td>
                <td>
                    <input 
                        type="number" 
                        id="week-${weekNumber}" 
                        class="hours-input" 
                        min="0" 
                        max="168" 
                        step="0.5" 
                        placeholder="0.0"
                        disabled
                        data-week="${weekNumber}"
                    />
                    <span class="error-message" id="error-${weekNumber}"></span>
                </td>
                <td>
                    <span class="status-badge status-pending" id="status-${weekNumber}">${translations[currentLanguage]['status-pending']}</span>
                </td>
            `;
            return row;
        }

        function getOrdinal(number) {
            if (currentLanguage === 'en') {
                const suffixes = ['th', 'st', 'nd', 'rd'];
                const value = number % 100;
                return number + (suffixes[(value - 20) % 10] || suffixes[value] || suffixes[0]);
            } else if (currentLanguage === 'zh-hk') {
                const chineseNumbers = ['', 'ä¸€', 'äºŒ', 'ä¸‰', 'å››', 'äº”', 'å…­', 'ä¸ƒ', 'å…«', 'ä¹', 'å', 'åä¸€', 'åäºŒ'];
                return chineseNumbers[number] || number.toString();
            } else if (currentLanguage === 'zh-cn') {
                const chineseNumbers = ['', 'ä¸€', 'äºŒ', 'ä¸‰', 'å››', 'äº”', 'å…­', 'ä¸ƒ', 'å…«', 'ä¹', 'å', 'åä¸€', 'åäºŒ'];
                return chineseNumbers[number] || number.toString();
            }
            return number.toString();
        }

        function attachEventListeners() {
            document.getElementById('calculate-btn').addEventListener('click', calculate468Rule);
            document.getElementById('reset-btn').addEventListener('click', resetForm);
            
            // Attach input validation to each week input
            for (let i = 1; i <= 12; i++) {
                const input = document.getElementById(`week-${i}`);
                input.addEventListener('input', function() {
                    validateAndUpdateWeek(i);
                });
                input.addEventListener('blur', function() {
                    validateInput(i);
                });
            }
        }

        function validateAndUpdateWeek(weekNumber) {
            const input = document.getElementById(`week-${weekNumber}`);
            const value = input.value.trim();
            
            // Clear previous error
            clearError(weekNumber);
            
            if (value === '') {
                weekData[weekNumber - 1] = null;
                updateWeekStatus(weekNumber, 'pending');
                disableSubsequentWeeks(weekNumber);
                return;
            }
            
            const hours = parseFloat(value);
            
            if (isNaN(hours)) {
                showError(weekNumber, errorMessages[currentLanguage].INVALID_NUMBER);
                return;
            }
            
            if (hours < 0) {
                showError(weekNumber, errorMessages[currentLanguage].NEGATIVE_VALUE);
                return;
            }
            
            if (hours > 168) {
                showError(weekNumber, errorMessages[currentLanguage].EXCEEDS_LIMIT);
                return;
            }
            
            // Valid input
            weekData[weekNumber - 1] = hours;
            calculateWeekStatus(weekNumber);
            enableNextWeek(weekNumber);
        }

        function validateInput(weekNumber) {
            const input = document.getElementById(`week-${weekNumber}`);
            const value = input.value.trim();
            
            if (value !== '' && weekData[weekNumber - 1] === null) {
                input.classList.add('error');
            } else {
                input.classList.remove('error');
            }
        }

        function calculateWeekStatus(weekNumber) {
            if (weekNumber < 4) {
                // Need at least 4 weeks to determine status
                updateWeekStatus(weekNumber, 'not-fulfilled');
                return;
            }
            
            // Don't update individual week status here - will be handled in calculate468Rule
            // This prevents premature status updates
        }

        function checkWeekQualification(weekIndex) {
            if (weekIndex < 3) return false; // Need at least 4 weeks
            
            // Method 1: Check if last 4 weeks all have 17+ hours
            let consecutiveWeeks = true;
            let totalHours = 0;
            
            for (let i = weekIndex - 3; i <= weekIndex; i++) {
                if (weekData[i] === null) return false;
                
                totalHours += weekData[i];
                if (weekData[i] < 17) {
                    consecutiveWeeks = false;
                }
            }
            
            // Method 1: 4 consecutive weeks with 17+ hours each
            if (consecutiveWeeks) return true;
            
            // Method 2: 68+ total hours over 4 consecutive weeks
            if (totalHours >= 68) return true;
            
            return false;
        }

        function updateWeekStatus(weekNumber, status) {
            const statusElement = document.getElementById(`status-${weekNumber}`);
            const statusKey = `status-${status === 'fulfilled' ? 'qualified' : status === 'not-fulfilled' ? 'not-qualified' : 'pending'}`;
            
            statusElement.className = `status-badge status-${status}`;
            statusElement.textContent = translations[currentLanguage][statusKey];
        }

        function enableNextWeek(weekNumber) {
            if (weekNumber < 12 && weekData[weekNumber - 1] !== null) {
                const nextInput = document.getElementById(`week-${weekNumber + 1}`);
                if (nextInput) {
                    nextInput.disabled = false;
                }
            }
        }

        function disableSubsequentWeeks(fromWeek) {
            for (let i = fromWeek + 1; i <= 12; i++) {
                const input = document.getElementById(`week-${i}`);
                if (input) {
                    input.disabled = true;
                    input.value = '';
                    weekData[i - 1] = null;
                    updateWeekStatus(i, 'pending');
                }
            }
        }

        function showError(weekNumber, message) {
            const errorElement = document.getElementById(`error-${weekNumber}`);
            const inputElement = document.getElementById(`week-${weekNumber}`);
            
            errorElement.textContent = message;
            inputElement.classList.add('error');
        }

        function clearError(weekNumber) {
            const errorElement = document.getElementById(`error-${weekNumber}`);
            const inputElement = document.getElementById(`week-${weekNumber}`);
            
            errorElement.textContent = '';
            inputElement.classList.remove('error');
        }

        function calculate468Rule() {
            // Reset all statuses first
            for (let i = 4; i <= 12; i++) {
                if (weekData[i - 1] !== null) {
                    updateWeekStatus(i, 'not-fulfilled');
                }
            }
            
            // Mark all qualifying 4-week periods
            markQualifyingPeriods();
            
            displayResults();
        }

        function markQualifyingPeriods() {
            // Check each possible 4-week period
            for (let endWeek = 4; endWeek <= 12; endWeek++) {
                const endIndex = endWeek - 1; // Convert to 0-based index
                
                // Skip if any week in the 4-week period is null
                let hasAllData = true;
                for (let i = endIndex - 3; i <= endIndex; i++) {
                    if (weekData[i] === null) {
                        hasAllData = false;
                        break;
                    }
                }
                
                if (!hasAllData) continue;
                
                // Check Method 1: All 4 weeks have 17+ hours
                let allWeeksAbove17 = true;
                let totalHours = 0;
                
                for (let i = endIndex - 3; i <= endIndex; i++) {
                    totalHours += weekData[i];
                    if (weekData[i] < 17) {
                        allWeeksAbove17 = false;
                    }
                }
                
                // Check Method 2: Total hours >= 68
                const totalAbove68 = totalHours >= 68;
                
                // If either method qualifies, mark all 4 weeks as fulfilled
                if (allWeeksAbove17 || totalAbove68) {
                    for (let i = endIndex - 3; i <= endIndex; i++) {
                        const weekNumber = i + 1; // Convert back to 1-based
                        updateWeekStatus(weekNumber, 'fulfilled');
                    }
                }
            }
        }

        function displayResults() {
            const summaryElement = document.getElementById('summary-results');
            const weeksCompletedElement = document.getElementById('weeks-completed');
            const qualifiedWeeksElement = document.getElementById('qualified-weeks');
            const firstQualificationElement = document.getElementById('first-qualification');
            const qualificationStatusElement = document.getElementById('qualification-status');
            
            // Calculate summary statistics
            const completedWeeks = weekData.filter(week => week !== null).length;
            let qualifiedWeeks = 0;
            let firstQualificationWeek = null;
            
            for (let i = 3; i < 12; i++) { // Start from week 4 (index 3)
                if (weekData[i] !== null && checkWeekQualification(i)) {
                    qualifiedWeeks++;
                    if (firstQualificationWeek === null) {
                        firstQualificationWeek = i + 1; // Convert to 1-based
                    }
                }
            }
            
            // Update summary cards
            weeksCompletedElement.textContent = completedWeeks;
            qualifiedWeeksElement.textContent = qualifiedWeeks;
            firstQualificationElement.textContent = firstQualificationWeek ? `Week ${firstQualificationWeek}` : '--';
            
            // Update qualification status
            if (qualifiedWeeks > 0) {
                qualificationStatusElement.className = 'qualification-status qualified';
                let message = translations[currentLanguage]['qualified-message'];
                if (firstQualificationWeek) {
                    const weekText = currentLanguage === 'en' ? `starting from Week ${firstQualificationWeek}` :
                                   currentLanguage === 'zh-hk' ? `ç”±ç¬¬${getOrdinal(firstQualificationWeek)}é€±é–‹å§‹` :
                                   `ä»ç¬¬${getOrdinal(firstQualificationWeek)}å‘¨å¼€å§‹`;
                    message += `<br>${weekText}`;
                }
                qualificationStatusElement.innerHTML = message;
            } else if (completedWeeks >= 4) {
                qualificationStatusElement.className = 'qualification-status not-qualified';
                qualificationStatusElement.innerHTML = translations[currentLanguage]['not-qualified-message'];
            } else {
                qualificationStatusElement.className = 'qualification-status not-qualified';
                qualificationStatusElement.innerHTML = translations[currentLanguage]['pending-message'];
            }
            
            // Show results with animation
            summaryElement.style.display = 'block';
            summaryElement.classList.add('fade-in');
            
            // Scroll to results
            summaryElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        function resetForm() {
            // Clear all inputs
            for (let i = 1; i <= 12; i++) {
                const input = document.getElementById(`week-${i}`);
                input.value = '';
                input.disabled = i > 1; // Only enable first week
                input.classList.remove('error');
                
                clearError(i);
                updateWeekStatus(i, 'pending');
            }
            
            // Reset week data
            weekData = new Array(12).fill(null);
            
            // Hide results
            document.getElementById('summary-results').style.display = 'none';
            
            // Enable first week
            document.getElementById('week-1').disabled = false;
        }
    </script>
</body>
</html>